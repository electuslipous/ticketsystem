<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="flex flex-col p-10 min-h-screen">
  <div class="w-full h-full mx-auto">
    <h1 class="text-3xl font-bold mb-6 border-b-2 border-black">Price Calculator</h1>
    <div class="flex flex-col items-center mb-4">
      <div class="mb-4 p-2">
        <button onclick="setPrice1()" class="bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded">1
          Ticket</button>
        <button onclick="setPrice5()" class="bg-cyan-500 hover:bg-cyan-600 text-white py-2 px-4 rounded">5
          Tickets</button>
        <button onclick="setPrice10()" class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded">10
          Tickets</button>
      </div>
      <label for="numTickets" class="mr-2 text-2xl mb-2">Number of Tickets:</label>
      <input onkeypress="calculatePrice()" type="number" id="numTickets" class="border rounded p-2 w-22">
      <!-- OUTPUT START-->
      <div id="output" class="mt-2 mb-2 flex flex-row gap-3">&nbsp;</div>
      <!-- OUTPUT END -->
    </div>

  </div>
  <div class="w-full mx-auto">
    <h1 class="text-3xl font-bold mb-6 border-b-2 border-black">Session</h1>
    <div class="flex flex-col md:grid md:gap-2 md:grid-cols-2	border-2 items-start mt-2 mb-4">
      <div class="mb-4 p-2 flex gap-2 justify-center">
        <button onclick="setPrice1()" class="bg-red-600 hover:bg-red-500 text-white py-2 px-4 rounded">Clear
          session</button>
        <button onclick="setPrice5()" class="bg-cyan-500 hover:bg-cyan-600 text-white py-2 px-4 rounded"></button>
        <button onclick="setPrice10()" class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded">10
          Tickets</button>
      </div>
      <div class="mb-4 p-2">
        <div class="flex gap-2">
          <h1 class="font-bold">Session total: </h1>
          <span> 100</span>
          <span>ft</span>
        </div>
        <div class="flex flex-col gap-2">
          <h1 class="font-bold text-center bg-green-100 mt-1">Past transactions</h1>
          <table class="table-fixed overflow-scroll" style="height:100px;" id="sessionTable">
            <thead>
              <tr class="border-b-2">
                <th>Time</th>
                <th>Qty</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    function makeButton(text, color, func) { return `<button onclick="${func}" class="bg-${color}-500 hover:bg-${color}-600 text-white py-2 mr-2 px-4 rounded">${text}</button>` };
    function calculatePrice() {
      const numTicketsInput = document.getElementById('numTickets');
      const numTickets = parseInt(numTicketsInput.value);
      let totalPrice = 0;
      let freeTickets = 0;

      if (numTickets == null) {
        totalPrice = 0;
      } else if (numTickets >= 5) {
        const extraTickets = Math.floor(numTickets / 5);
        freeTickets = extraTickets;
        totalPrice = numTickets * 500;
      } else {
        totalPrice = numTickets * 500;
      }

      output.textContent = `Total Price: ft ${totalPrice.toLocaleString('hu-HU')}. Free Tickets: ${freeTickets}`;
    }

    function setPrice1() {
      output.textContent = "Total Price: ft 500. Free Tickets: 0"
    }
    function setPrice5() {
      output.textContent = "Total Price: ft 2500. Free Tickets: 1"
    }
    function setPrice10() {
      output.innerHTML = `<div><p class="font-bold mb-2 text-2xl">Total Price: 5000 ft. Free Tickets: 2 </p>${makeButton('Save', 'green', "saveToSession('10',5000)")}${makeButton('Cancel', 'red', 'cancelOffer()')}</div>`
    }

    const numTicketsInput = document.getElementById('numTickets');
    numTicketsInput.addEventListener('input', calculatePrice)

    function cancelOffer() {
      output.innerHTML = "";
    }

    function saveToSession(quantity, total) {
      const table = document.getElementById("sessionTable")
      const newRow = table.insertRow()

      const cell1 = newRow.insertCell(0);
      cell1.textContent = new Date().toLocaleString();

      const cell2 = newRow.insertCell(1);
      cell2.textContent = quantity;

      const cell3 = newRow.insertCell(2);
      cell3.textContent = total;
      table.insertRow(0)

    }

  </script>
</body>

</html>